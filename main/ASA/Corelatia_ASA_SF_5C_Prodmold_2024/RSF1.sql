
SELECT *
FROM USER_BANCU.VVW_KATALOG_SF_2024;

CREATE OR REPLACE FORCE VIEW USER_BANCU.VVW_KATALOG_SF_2024

AS 

SELECT 
*
FROM
(

SELECT 
D.CUIIO,
D.CAEM2,
SUM(CASE WHEN D.CAPITOL IN (1092) AND  D.RIND IN ('010') THEN D.COL1 ELSE NULL END ) RSF_010_COL3,
SUM(CASE WHEN D.CAPITOL IN (1092) AND  D.RIND IN ('010') THEN D.COL2 ELSE NULL END ) RSF_010_COL4,
SUM(CASE WHEN D.CAPITOL IN (1092) AND  D.RIND IN ('040') THEN D.COL1 ELSE NULL END ) RSF_040_COL3,
SUM(CASE WHEN D.CAPITOL IN (1092) AND  D.RIND IN ('040') THEN D.COL2 ELSE NULL END ) RSF_040_COL4,
SUM(CASE WHEN D.CAPITOL IN (1090) AND  D.RIND IN ('290') THEN D.COL1 ELSE NULL END ) RSF_290_COL3,
SUM(CASE WHEN D.CAPITOL IN (1090) AND  D.RIND IN ('290') THEN D.COL2 ELSE NULL END ) RSF_290_COL4,
SUM(CASE WHEN D.CAPITOL IN (1090) AND  D.RIND IN ('260') THEN D.COL1 ELSE NULL END ) RSF_260_COL3,
SUM(CASE WHEN D.CAPITOL IN (1090) AND  D.RIND IN ('260') THEN D.COL2 ELSE NULL END ) RSF_260_COL4,
SUM(CASE WHEN D.CAPITOL IN (1090) AND  D.RIND IN ('270') THEN D.COL1 ELSE NULL END ) RSF_270_COL3,
SUM(CASE WHEN D.CAPITOL IN (1090) AND  D.RIND IN ('270') THEN D.COL2 ELSE NULL END ) RSF_270_COL4,
SUM(CASE WHEN D.CAPITOL IN (1090) AND  D.RIND IN ('280') THEN D.COL1 ELSE NULL END ) RSF_280_COL3,
SUM(CASE WHEN D.CAPITOL IN (1090) AND  D.RIND IN ('280') THEN D.COL2 ELSE NULL END ) RSF_280_COL4,
NULL RSF_060_COL3,
NULL RSF_060_COL4


FROM
       CIS2.VW_DATA_ALL_FR D             
WHERE 
  D.FORM IN (57)           AND 
  D.CAPITOL_VERS  <= 2013 AND         
  D.CAPITOL IN (1092,1090) AND
  D.FORM_VERS = 2009  AND 
  D.FORM = 57 AND
  D.PERIOADA IN (2013) --AND 
  --D.RIND IN ('010','040')
  --AND D.CUIIO = 297922
  GROUP BY
 D.CUIIO,
D.CAEM2
  
  
  UNION 
  
  SELECT 
D.CUIIO,
D.CAEM2,
SUM(CASE WHEN D.CAPITOL IN (1121) AND D.RIND IN ('010') THEN D.COL1 ELSE NULL END ) RSF_010_COL3,
SUM(CASE WHEN D.CAPITOL IN (1121) AND D.RIND IN ('010') THEN D.COL2 ELSE NULL END ) RSF_010_COL4,
SUM(CASE WHEN D.CAPITOL IN (1121) AND D.RIND IN ('040') THEN D.COL1 ELSE NULL END ) RSF_040_COL3,
SUM(CASE WHEN D.CAPITOL IN (1121) AND D.RIND IN ('040') THEN D.COL2 ELSE NULL END ) RSF_040_COL4,
NULL RSF_290_COL3,
NULL RSF_290_COL4,
NULL RSF_260_COL3,
NULL RSF_260_COL4,
NULL RSF_270_COL3,
NULL RSF_270_COL4,
NULL RSF_280_COL3,
NULL RSF_280_COL4,
SUM(CASE WHEN D.CAPITOL IN (1120) AND D.RIND IN ('060') THEN D.COL1 ELSE NULL END ) RSF_060_COL3,
SUM(CASE WHEN D.CAPITOL IN (1120) AND D.RIND IN ('060') THEN D.COL2 ELSE NULL END ) RSF_060_COL4

FROM
       CIS2.VW_DATA_ALL_FR D             
WHERE 
  D.FORM IN (63)           AND 
  D.CAPITOL_VERS  <= 2013 AND         
  D.CAPITOL IN (1121,1120) AND
  D.FORM_VERS = 2000  AND 
  D.FORM = 63 AND
  D.PERIOADA IN (2013) AND 
  D.RIND IN ('010','040','060')
  --AND D.CUIIO = 5523
  GROUP BY
D.CUIIO,
D.CAEM2
  
  
)