--DROP VIEW USER_BANCU.VVW_KATALOG_5_C_2023;

CREATE OR REPLACE FORCE VIEW USER_BANCU.VVW_KATALOG_5_C_2024

AS 
select 

D.CUIIO,
max(D.CAEM2) CAEM2,
SUM(CASE WHEN D.CAPITOL = 1 AND D.RIND IN '2000' THEN D.COL1 ELSE NULL END) AS CAP_1_R_2000_1,
SUM(CASE WHEN D.CAPITOL = 1 AND D.RIND IN '2000' THEN D.COL2 ELSE NULL END) AS CAP_1_R_2000_2,
SUM(CASE WHEN D.CAPITOL = 1 AND D.RIND IN '2300' THEN D.COL1 ELSE NULL END) AS CAP_1_R_2300_1,
SUM(CASE WHEN D.CAPITOL = 1 AND D.RIND IN '2300' THEN D.COL2 ELSE NULL END) AS CAP_1_R_2300_2,
SUM(CASE WHEN D.CAPITOL = 1 AND D.RIND IN '2400' THEN D.COL1 ELSE NULL END) AS CAP_1_R_2400_1,
SUM(CASE WHEN D.CAPITOL = 1 AND D.RIND IN '2400' THEN D.COL2 ELSE NULL END) AS CAP_1_R_2400_2,
SUM(CASE WHEN D.CAPITOL = 1 AND D.RIND IN '2500' THEN D.COL1 ELSE NULL END) AS CAP_1_R_2500_1,
SUM(CASE WHEN D.CAPITOL = 1 AND D.RIND IN '2500' THEN D.COL2 ELSE NULL END) AS CAP_1_R_2500_2,
SUM(CASE WHEN D.CAPITOL = 2 AND D.RIND IN '0100' THEN D.COL1 ELSE NULL END) AS RIND_0100,
SUM(CASE WHEN D.CAPITOL = 2 AND D.RIND IN '0180' THEN D.COL1 ELSE NULL END) AS RIND_0180,
SUM(CASE WHEN D.CAPITOL = 2 AND D.RIND IN '0190' THEN D.COL1 ELSE NULL END) AS RIND_0190,
SUM(CASE WHEN D.CAPITOL = 2 AND D.RIND IN '0200' THEN D.COL1 ELSE NULL END) AS RIND_0200,
SUM(CASE WHEN D.CAPITOL = 2 AND D.RIND IN '0300' THEN D.COL1 ELSE NULL END) AS RIND_0300,
SUM(CASE WHEN D.CAPITOL = 2 AND D.RIND IN '0500' THEN D.COL1 ELSE NULL END) AS RIND_0500,
SUM(CASE WHEN D.CAPITOL = 2 AND D.RIND IN '0700' THEN D.COL1 ELSE NULL END) AS RIND_0700,
SUM(CASE WHEN D.CAPITOL = 2 AND D.RIND IN '0800' THEN D.COL1 ELSE NULL END) AS RIND_0800,
SUM(CASE WHEN D.CAPITOL = 2 AND D.RIND IN '0900' THEN D.COL1 ELSE NULL END) AS RIND_0900,
SUM(CASE WHEN D.CAPITOL = 2 AND D.RIND IN '1000' THEN D.COL1 ELSE NULL END) AS RIND_1000,
SUM(CASE WHEN D.CAPITOL = 2 AND D.RIND IN '1010' THEN D.COL1 ELSE NULL END) AS RIND_1010








    from CIS.VW_DATA_ALL D 
  --              INNER JOIN CIS.RENIM R ON R.CUIIO = D.CUIIO AND R.CUIIO_VERS = D.CUIIO_VERS
    --            INNER JOIN CIS.VW_CL_CUATM C ON C.CODUL = D.CUATM 

where 

D.FORM = 1

AND 

D.PERIOADA IN (1060,1061,1062,1063)
AND D.CAPITOL IN (2,1)
--AND D.CUIIO = 400001
--AND D.RIND IN ('0100')

GROUP by
--D.PERIOADA,
D.CUIIO
--D.CUIIO_VERS,
--R.DENUMIRE, 
--D.CUATM,
--D.CAEM2,
--C.FULL_CODE

--ORDER BY
--C.FULL_CODE,
--D.CUIIO
--D.CUIIO_VERS
;
