INSERT INTO CIS2.TABLE_OUT 
(
  PERIOADA,
  FORM,
  FORM_VERS,
  ID_MDTABLE,
  COD_CUATM,
  NR_SECTIE,
  NUME_SECTIE,
  NR_SECTIE1,
  NUME_SECTIE1,
  NR_SECTIE2,
  NUME_SECTIE2,
  NR_ROW,
  ORDINE,
  DECIMAL_POS,
  NUME_ROW,  
  COL1,
  COL2,
  COL3,
  COL4,
  COL5
)

SELECT 
:pPERIOADA AS PERIOADA,
:pFORM AS FORM,
:pFORM_VERS AS FORM_VERS,
:pID_MDTABLE AS ID_MDTABLE,
:pCOD_CUATM AS COD_CUATM,    
'0' AS NR_SECTIE,
'0' AS NUME_SECTIE,
'0' AS NR_SECTIE1,
'0' AS NUME_SECTIE1,
'0' AS NR_SECTIE2,
'0' AS NUME_SECTIE2, 
COL1||'~'||ROWNUM NR_ROW,
ROWNUM AS ORDINE,
'000000' AS DECIMAL_POS, 
RIND_DENUMIRE AS NUME_ROW,
COL2 AS COL1,
COL3 AS COL2,
COL4 AS COL3,
COL5 AS COL4,
COL6 AS COL5


FROM
(


SELECT 
NR_TABLE,
TABLE_DENUMIRE,
RIND_DENUMIRE,
ROWNUM ORDINE,
COL1,
COL2 AS COL2,
COL3 AS COL3,
COL4 AS COL4,
COL5,
COL6

FROM 
(
SELECT 
3 AS NR_TABLE, 
'CAEM2' AS TABLE_DENUMIRE,
CC.RINDOUT  RIND_DENUMIRE,
CC.RIND full_code,  
  
  COUNT(DISTINCT CASE WHEN  D.RIND IN ('1.1.1','1.1.2','1.5.1','1.5.2','1.5.3','1.5.4','1.5.5','1.5.6','1.5.7') AND NVAL(D.COL1) >= 1 
     THEN D.CUIIO END) AS COL1,
     
     
      COUNT(DISTINCT CASE WHEN  D.RIND IN ('1.1.1','1.1.2','1.5.1','1.5.2','1.5.3','1.5.4','1.5.5','1.5.6','1.5.7') AND NVAL(D.COL1) >= 1  
      
      AND CU.FULL_CODE  LIKE '%'||'0100000'||';%'
           THEN D.CUIIO END) AS COL2,
           
            COUNT(DISTINCT CASE WHEN  D.RIND IN ('1.1.1','1.1.2','1.5.1','1.5.2','1.5.3','1.5.4','1.5.5','1.5.6','1.5.7') AND NVAL(D.COL1) >= 1  
      
      AND CU.FULL_CODE  LIKE '%'||'1111111'||';%'
           THEN D.CUIIO END) AS COL3,
            COUNT(DISTINCT CASE WHEN  D.RIND IN ('1.1.1','1.1.2','1.5.1','1.5.2','1.5.3','1.5.4','1.5.5','1.5.6','1.5.7') AND NVAL(D.COL1) >= 1  
      
      AND CU.FULL_CODE  LIKE '%'||'2222222'||';%'
           THEN D.CUIIO END) AS COL4,
           
            COUNT(DISTINCT CASE WHEN  D.RIND IN ('1.1.1','1.1.2','1.5.1','1.5.2','1.5.3','1.5.4','1.5.5','1.5.6','1.5.7') AND NVAL(D.COL1) >= 1  
      
      AND CU.FULL_CODE  LIKE '%'||'3333333'||';%'
           THEN D.CUIIO END) AS COL5,
           
                     COUNT(DISTINCT CASE WHEN  D.RIND IN ('1.1.1','1.1.2','1.5.1','1.5.2','1.5.3','1.5.4','1.5.5','1.5.6','1.5.7') AND NVAL(D.COL1) >= 1  
      
      AND CU.FULL_CODE  LIKE '%'||'9600000'||'%'
           THEN D.CUIIO END) AS COL6
     
   
    
FROM 
  CIS2.VW_DATA_ALL D 
  
 
            
            INNER JOIN  CIS2.VW_CL_CUATM  CU ON CU.CODUL = D.CUATM
            INNER JOIN  CIS2.MD_RIND_OUT  C ON C.RINDOUT = D.CAEM2 AND C.ID_MDTABLE = 14569 
            INNER JOIN  CIS2.MD_RIND_OUT  CC   
            
            
  ON C.RIND LIKE '%'||CC.RINDOUT||';%' AND CC.ID_MDTABLE = 14569  
            INNER JOIN CIS2.RENIM R ON R.CUIIO = D.CUIIO AND R.CUIIO_VERS = D.CUIIO_VERS 





    

WHERE
  D.PERIOADA IN (:pPERIOADA) AND
  D.FORM IN (:pFORM) AND 
  D.capitol=1040 AND  
 D.RIND IN ('1.1.1','1.1.2','1.5.1','1.5.2','1.5.3','1.5.4','1.5.5','1.5.6','1.5.7')
  AND D.CAEM2 NOT LIKE 'A%'
   -- AND D.CUIIO = 458963

  GROUP BY
CC.RIND,
CC.RINDOUT  
ORDER BY
CC.RIND

  )
  )
  
  
  
  WHERE
  
  
  COL1 <> 0
  OR  
  COL2 <> 0
  OR 
  COL3 <> 0
  OR  
  COL4 <> 0
  OR 
  COL5 <> 0
  OR 
  COL6 <> 0
  
  